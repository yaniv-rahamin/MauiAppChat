<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="MauiAppChat.Views.SigninPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:local="clr-namespace:MauiAppChat.Views"
    xmlns:viewmodels="clr-namespace:MauiAppChat.ViewModels"
    x:DataType="viewmodels:SigninPageViewModel"
    FlowDirection="RightToLeft">
    <ScrollView>
        <VerticalStackLayout Padding="30" Spacing="20">
            <Border
                Padding="20"
                BackgroundColor="White"
                Stroke="LightGray"
                StrokeShape="RoundRectangle 20"
                StrokeThickness="1">

                <VerticalStackLayout Spacing="16">

                    <Label
                        FontAttributes="Bold"
                        FontSize="24"
                        HorizontalOptions="Center"
                        Text="התחברות" />

                    <Label FontAttributes="Bold" Text="אימייל" />
                    <Grid
                        Margin="0,0,0,0"
                        ColumnDefinitions="Auto,*,40"
                        VerticalOptions="Center">
                        <Label
                            Margin="5,0"
                            FontFamily="MaterialIcons-Regular"
                            FontSize="24"
                            Text="&#xE0BE;"
                            TextColor="Gray"
                            VerticalTextAlignment="Center" />
                        <Entry
                            Grid.Column="1"
                            Keyboard="Email"
                            Placeholder="הכנס כתובת אימייל"
                            Text="{Binding Email}" />
                    </Grid>
                    <Label
                        Margin="40,0"
                        FontSize="12"
                        Text="אימייל לא תקין"
                        TextColor="Red"
                        IsVisible="{Binding IsEmailInvalid}" />

                    <Label FontAttributes="Bold" Text="סיסמה" />
                    <Grid
                        Margin="0,0,0,0"
                        ColumnDefinitions="Auto,*,40"
                        VerticalOptions="Center">

                        <Label
                            Margin="5,0"
                            FontFamily="MaterialIcons-Regular"
                            FontSize="24"
                            Text="&#xE897;"
                            TextColor="Gray"
                            VerticalTextAlignment="Center" />
                        <Entry
                            Grid.Column="1"
                            IsPassword="{Binding IsPassword}"                         
                            Placeholder="בחר סיסמא"
                            Text="{Binding Password }" />
                        <Button
                            Grid.Column="2"
                            BackgroundColor="Transparent"
                            Command="{Binding TogglePasswordCommand}"
                            FontFamily="MaterialIcons-Regular"
                            Text="{Binding PasswordIcon}"
                            TextColor="Black" />
                    </Grid>
                    <Label
                        Margin="40,0"
                        FontSize="12"
                        Text="צריך לפחות שישה תווים"
                        TextColor="Red"
                        IsVisible="{Binding IsPasswordInvalid}"/>
                    <Button
                        Margin="0,10"
                        Padding="12"
                        BackgroundColor="#007AFF"
                        Command="{Binding LoginCommand}"
                        CornerRadius="10"
                        Text="התחבר"
                        TextColor="White" />

                    <Label
                        FontAttributes="Bold"
                        HorizontalOptions="Center"
                        Text="שכחת סיסמה?"
                        TextColor="#007AFF">
                        <Label.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding NavigateToRecoveryPasswordPage}" />
                        </Label.GestureRecognizers>
                    </Label>

                    <Label
                        Margin="0,10,0,0"
                        FlowDirection="RightToLeft"
                        HorizontalOptions="Center">
                        <Label.FormattedText>
                            <FormattedString>
                                <Span
                                    FontAttributes="None"
                                    FontSize="15"
                                    Text="אין לך עדיין חשבון? "
                                    TextColor="Black" />
                                <Span
                                    FontAttributes="Bold"
                                    FontSize="15"
                                    Text="הרשמה"
                                    TextColor="#007AFF" />
                            </FormattedString>
                        </Label.FormattedText>
                        <Label.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding NavigateToSignupPage}" />
                        </Label.GestureRecognizers>
                    </Label>

                    <ActivityIndicator
                        Margin="0,10"
                        HorizontalOptions="Center"
                        IsRunning="{Binding IsBusy}"
                        IsVisible="{Binding IsBusy}"
                        VerticalOptions="Center"
                        Color="Gray" />

                </VerticalStackLayout>
            </Border>
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>